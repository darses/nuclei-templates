id: dns-interactsh-detect

info:
  name: Interactsh DNS server - Detect
  author: darses
  severity: low
  description: |
    Detect Interactsh DNS service. Interactsh is used for Out-of-band Application Security Testing (OAST).
  metadata:
    verified: true
    max-request: 4
    vendor: projectdiscovery
    product: interactsh
  classification:
    cpe: cpe:2.3:a:projectdiscovery:interactsh:*:*:*:*:*:*:*:*
  reference: https://github.com/projectdiscovery/interactsh
  tags: dns,detect,discovery,interactsh

flow: dns(1) && dns(2) && dns(3) && dns(4)
dns:
  - name: "aws.{{FQDN}}"
    type: A

    matchers:
      - type: word
        words:
          - 169.254.169.254
        internal: true

  - name: "alibaba.{{FQDN}}"
    type: A

    matchers:
      - type: word
        words:
          - 100.100.100.200
        internal: true

  - name: "oracle.{{FQDN}}"
    type: A

    matchers:
      - type: word
        words:
          - 192.0.0.192
        internal: true

  - name: "{{FQDN}}"
    type: SOA

    matchers:
      - type: word
        words:
          - ns1
